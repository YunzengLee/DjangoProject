# AXF
## User
- 用户表设计
    - username
    - password
    - email
    - phone
    - icon
    - is_active
    - is_delete
###homework
- 邮箱校验
- 密码一致性校验
###高级密码安全工具
- 不再使用单一算法
    - 使用两种以上的算法
    - 算法中融入时间散列
- 输入数据哈希处理
- 哈希处理后拼接时间戳
    - 中间使用特定拼接符号
- 将拼好的数据进行编码
- 验证
    - 将输入进行相同的哈希处理
    - 将数据库密码解码
    - 去除时间散列的混淆
    - 比较
### 版本升级，密码不兼容的问题
- 第一版：明文
- 第二版：hash值
- 第三版：hash+时间散列
- 假定目前处于第三版本，如何兼容第一第二版本      
    - 对请求的参数加版本号，没添加的是旧版本
    - 对于低版本使用特定认证，后将低版本的版本号存下来
        - 小米低版本兼容
        - 除了密码，又加了验证码
###用户激活认证
- 途径
    - 邮件
    - 短信
    - 人工审核
- 邮件的逻辑最复杂
    - 发送邮件
        - 收件人地址
        - 发件人信息
            - 用户名 密码
            - 内容
            - 服务器
                - 邮件服务器
                - 端口
    - 点击邮件中的连接就激活
        - 凭什么? 链接的设计原则
        - 连接中存在用户的唯一标识
            - http://xxxx/activate/?u_token=YYYY
            - 参数token是具有时效性的唯一表设计
            - u_token放在缓存中作为key，value是user_id
            - 缓存可以使用django自带的，也可以使用redis（已经在mindmaster里记录了redis的使用方法）
            - u_token 使用UUID(通用唯一标识码)实现
            
        - 标识存在过期时间
        - 标识存在使用次数限制
###错误信息
- 存储错误信息在session中
    - 比如登录界面发起post请求时，记录密码错误的信息提示
    - 错误出现后会重定向到某个错误显示页面的url
- 在错误显示页面的url对应的视图函数中获取错误信息
    - 获取后删除session中的错误信息，保证错误信息只使用一次
    - 将从session中获取的错误信息存到data中，通过return render传给前端html页面
    - html页面看传过来的错误信息是否存在，存在则显示在页面上
### 购物车
- 多对多关系
    - 用户
    - 商品
- 订单
    - 订单和已购买商品是一对多关系
    - 表关系
        - 订单表
        - 订单商品表
            - 购物车里有订单商品表
        -  地址
            - 每个订单对应一个地址
            - 一个地址可以对应多个订单
            - 订单会级联收货地址表
        - 扩展内容
            - 优惠券
            - 积分
            - 评价
- 添加购物车
    - 需要用户，如果没有登录，跳转登录页
    - 需要商品
        - 传递商品唯一标识 如id
    - 添加的合法性验证
        - 此数据不存在，则创建购物车数据
        - 否则，直接将数量加1
##小技能
- js获取jQuery对象属性的话
    - 比如: <button class='btn ' zizhi='aaa'>
    - 在js中写这个按钮的点击事件，在点击事件中获取class值和zizhi值
    - attr函数
        - 可以获取任意属性，可以是自制的
    - prop函数
        - 只能属性内置属性，不包括自制的
## 浏览器行为
- 重定向（ajax发起的url请求不能返回重定向作为响应）
- 跨域检查
##项目中多块逻辑具有相同操作
- 封装函数
- 装饰器
- 中间件
###购物车全选按钮的逻辑梳理
- 默认状态
    - 全选按钮选中
        - 内部所有商品都选中
    - 全选按钮未选中
        - 内部商品中只要有一个未选中
- 点击全选的切换动作
    - 原状态是已选中
        - 全选和所有商品都变成未选中
    - 原状态是未选中
        - 全选和所有商品都变成选中
- 点击单个商品时
    - 商品由选中变成未选中
        - 全选一定变成未选中
    - 商品由未选中变选中
        - 全选的默认状态就是未选中
        - 可能变成选中
###购物车选中商品的价钱计算
- 写成函数放在views_helper中，方便调用
### 支付
- 官方文档（是最好的资源）
- 常见的支付
    - 支付宝
        - 企业资质
        - 营业执照
    - 微信
        - 要求同支付宝
        - 要认证，认证一次200，一年一次
    - 银联
### 部署
- settings里有个debug开关，关掉就出现静态资源不可用
- django默认使用的是开发者服务器
    - runserver
        - 提供了路由处理功能，动态资源处理
        - 如果是debug=True的话，还提供了静态资源处理功能
    - 功能健壮，但是性能较低，仅适用于开发
    - 
- 部署不会使用单一服务器
    - Apache
    - Nginx
        - http服务器
            - 处理静态资源
        - 反向代理
            - uWSGI HTTP服务器
            - gunicorn HTTP服务器
        - 邮件服务器
        - 流媒体服务器

